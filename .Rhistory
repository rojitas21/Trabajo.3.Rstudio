load("C:/Users/Javi/Downloads/Nueva carpeta/wvs_chile_trabajo_final.rdata")
load("wvs_chile.rdata")
setwd("D:/Desktop/Ayudantia 7")
install.packages("tidyverse")
install.packages("sjmisc")
install.packages("sjPlot")
install.packages("kableExtra")
library(tidyverse)
library(sjmisc)
library(sjPlot)
library(kableExtra)
wvs_chile %>% mutate(., posicion_politica = case_when(Q240 %in% c(1:3)~"Izquierda",
Q240 %in% c(4:6)~"Centro",
Q240 %in% c(7:10)~"Derecha",
TRUE~NA_character_))
wvs_chile %>% mutate(., posicion_politica = case_when(Q240 %in% c(1:3)~"Izquierda",
Q240 %in% c(4:6)~"Centro",
Q240 %in% c(7:10)~"Derecha",
TRUE~NA_character_))
#Cargar paquetes
pacman::p_load(tidyverse, #Conjunto de paquetes, sobre todo dplyr y ggplot2
car, #Para recodificar
haven,
summarytools, #Para descriptivos
sjmisc,
psych     # para Alfa de Chronbach
)
options(scipen = 999) # para desactivar notacion cientifica
rm(list = ls()) # para limpiar el entorno de trabajo
#Cargar base de datos
load(url("https://github.com/cursos-metodos-facso/investigacion-cuantitativa/raw/main/files/data/casen2022.RData"))
##DESCRIPCION DE VARIABLES
view(dfSummary(casen2022, headings=FALSE, graph.col = FALSE))
#Seleccionamos solo los indicadores que eran utilizados hasta 2014
indicadores2014 <- casen2022 %>% select(asistencia,
rezago,
escolaridad,
malnutricion,
sist_salud,
atencion,
ocupacion,
seg_social,
jubilacion,
hacinamiento,
estado_vivienda=vivienda,
serv_basicos)  %>%
na.omit() %>% # Eliminar Na's
mutate_all(~(as.numeric(.))) # Convertimos todas las variables a numéricas
#Seleccionamos solo los indicadores que eran utilizados hasta 2014
indicadores2014 <- casen2022 %>% select(asistencia,
rezago,
escolaridad,
malnutricion,
sist_salud,
atencion,
ocupacion,
seg_social,
jubilacion,
hacinamiento,
estado_vivienda=vivienda,
serv_basicos)  %>%
na.omit() %>% # Eliminar Na's
mutate_all(~(as.numeric(.))) # Convertimos todas las variables a numéricas
indicadores2014 = indicadores2014 %>%
rowwise() %>%
mutate(educ = mean(c(asistencia, rezago, escolaridad)),
salud = mean(c(malnutricion, sist_salud, atencion)),
trabajo= mean(c(ocupacion, seg_social, jubilacion)),
vivienda= mean(c(hacinamiento, estado_vivienda, serv_basicos))) %>%
ungroup()
#es posible obtener el índice de pobreza multidimensional a partir del promedio de las cuatro dimensiones.
indicadores2014 = indicadores2014 %>%
rowwise() %>%
mutate(pobreza = mean(c(educ, salud, trabajo, vivienda))) %>%
ungroup()
#lo que nos dael resultado:
indicadores2014 %>% select(pobreza) %>% head(10) # Primeros 10 casos
summary(indicadores2014$pobreza) # Resumen
prop.table(table(indicadores2014$pobreza))*100
indicadores2014 <- indicadores2014 %>% mutate(pobreza = case_when(pobreza>=0.25~"si",
prop.table(table(indicadores2014$pobreza))*100
##Medición de pobreza multidimensional en cinco dimensiones (desde 2016)
indicadores2016 <- casen2022 %>% select(asistencia,
indicadores2016 <- casen2022 %>% select(asistencia,
rezago,
escolaridad,
malnutricion,
sist_salud,
atencion,
ocupacion,
seg_social,
jubilacion,
habitabilidad,
serv_basicos,
entorno,
ap_part_social,
trato,
seguridad,
area,
region) %>%
na.omit() %>% # Eliminar Na's
mutate_all(~(as.numeric(.))) # Convertimos todas las variables a numéricas
indicadores2016 = indicadores2016 %>%
rowwise() %>%
mutate(educ = mean(c(asistencia, rezago, escolaridad)),
salud = mean(c(malnutricion, sist_salud, atencion)),
trabajo= mean(c(ocupacion, seg_social, jubilacion)),
vivienda= mean(c(habitabilidad, serv_basicos, entorno)),
redes_cohesion= mean(c(ap_part_social, trato, seguridad))) %>%
ungroup()
indicadores2016 = indicadores2016 %>%
rowwise() %>%
mutate(pobreza_pond = (educ*22.5) + (salud*22.5) + (trabajo*22.5) + (vivienda*22.5) + (redes_cohesion*10)) %>%
ungroup()
indicadores2016 %>% select(pobreza_pond) %>% head(10) # Primeros 10 casos
summary(indicadores2016$pobreza_pond) # Resumen
indicadores2016 <- indicadores2016 %>% mutate(pobreza = case_when(pobreza_pond>=22.5~"si",
pobreza_pond<22.5~"no")
)
prop.table(table(indicadores2016$pobreza))*100
#para poder conocer cómo se distribuye la pobreza multidimensional en Chile. Por ejemplo, porcentaje de pobreza multidimensional por región:
prop.table(table(indicadores2016$region, indicadores2016$pobreza), margin = 1)
#o pobreza multidimensional por zona geográfica 1) urbano 2) rural
prop.table(table(indicadores2016$area, indicadores2016$pobreza), margin = 1)
#Cargamos base de datos
load(url("https://dataverse.harvard.edu/api/access/datafile/7245118"))
#Visualizacion de datos
dim(elsoc_long_2016_2022.2)
##Filtrar base de datos
#para quedarnos con las observaciones correspondientes solamente a la ola 1, y además seleccionaremos los ítems de interés.
data2 <- elsoc_long_2016_2022.2 %>% filter(ola==1) %>%  # seleccionamos solo los casos de la ola 1
select(s11_01,s11_02,s11_03,s11_04,s11_05,s11_06,s11_07,s11_08,s11_09) # items sintomatologia depresiva
head(data2)
#verlo uno por uno
table(data2$s11_01)
##Recodficar- eliminar las NAs
data2 <- data2 %>%
set_na(., na = c(-888, -999)) %>%
na.omit()
##ANALISIS
#estimar correlacion-Dado que la escala tiene solamente una dimensión, estimaremos la correlación de toda la escala.
cor(data2)
##Estimarconsistencia interna- Alfa de chornbach
psych::alpha(data2)
data2 <- data2 %>%
rowwise() %>%
mutate(confianza_instituciones = sum(s11_01,s11_02,s11_03,s11_04,s11_05,s11_06,s11_07,s11_08,s11_09))
summary(data2$confianza_instituciones)
load("C:/Users/Javi/Desktop/practico 4"
load("C:/Users/Javi/Desktop/practico 4")
load("C:/Users/Javi/Desktop/practico 4")
load("C:/Users/Javi/Desktop/practico 4/input (Bases)"
load("C:/Users/Javi/Desktop/practico 4/input (Bases)/Latinobarometro_2023_Esp_Rdata_v1_0.rdata")
frq(proc_data$soc_diversa)
pacman::p_load(haven,
sjlabelled,
dplyr, #Manipulacion de datos
stargazer, #Tablas
sjmisc, # Tablas
summarytools, # Tablas
kableExtra, #Tablas
sjPlot, #Tablas y gráficos
corrplot, # Correlaciones
sessioninfo, # Información de la sesión de trabajo
ggplot2,  # Para la mayoría de los gráficos
mice)   #Para imputar NA's
load("C:/Users/Javi/Desktop/Trabajo.3.Rstudio/input/Latinobarometro_2023_Esp_Rdata_v1_0.rdata")
names(Latinobarometro_2023_Esp_v1_0)
load("C:/Users/Javi/Desktop/Trabajo.3.Rstudio/input/Latinobarometro_2023_Esp_Rdata_v1_0.rdata")
load("C:/Users/Javi/Desktop/Trabajo.3.Rstudio/input/proc_data.rdata")
#Comprobar
names(proc_data)
summary(proc_data)
sjlabelled::get_label(proc_data)
frq(proc_data$idenpa)
frq(proc_data$P19N)
frq(proc_data$P32INN)
frq(proc_data$P33N.D)
frq(proc_data$P33N.C)
frq(proc_data$P33N.A)
#Comprobamos:
names(proc_data)
view_df(proc_data)
frq(proc_data$idenpa)
frq(proc_data$soc_diversa)
proc_data$soc_diversa <- factor(proc_data$soc_diversa,
lables = c("Sociedad defiende costumbres", "Sociedad abierta a diversidad"),
levels = c(1, 2))
frq(proc_data$soc_diversa)
proc_data$soc_diversa <- factor(proc_data$soc_diversa,
lables = c("Sociedad defiende costumbres", "Sociedad abierta a diversidad"),
levels = c(1, 2))
proc_data$soc_diversa <- factor(proc_data$soc_diversa,
labels = c("Sociedad defiende costumbres", "Sociedad abierta a diversidad"),
levels = c(1, 2))
frq(proc_data$soc_diversa)
proc_data$inmi_ideycul <- factor(proc_data$inmi_ideycul,
labels = c("Muy de acuerdo", "De acuerdo", "En desacuerdo", "Muy en desacuerdo"),
levels = c(1, 2, 3, 4))
frq(proc_data$inmi_ideycul)
proc_data$inmi_eco <- factor(proc_data$inmi_eco,
labels = c("Muy de acuerdo", "De acuerdo", "En desacuerdo", "Muy en desacuerdo"),
levels = c(1, 2, 3, 4))
graf_soc_diversa <- ggplot(proc_data, aes(x = soc_diversa)) +
geom_bar(fill = "pink") +
labs (title = "Percepción de la diversidad social")
View(graf_soc_diversa)
graf_soc_diversa <- ggplot(proc_data, aes(x = soc_diversa)) +
geom_bar(fill = "pink") +
labs (title = "Percepción de la diversidad social")
ggsave(graf_soc_diversa, file="output/graf_soc_diversa.png")
ggsave(graf_soc_diversa, file="output/graf_soc_diversa.png")
proc_data$soc_diversa <- factor(proc_data$soc_diversa,
labels = c("Sociedad defiende costumbres", "Sociedad abierta a diversidad"),
levels = c(1, 2))
proc_data$inmi_ideycul <- factor(proc_data$inmi_ideycul,
labels = c("Muy de acuerdo", "De acuerdo", "En desacuerdo", "Muy en desacuerdo"),
levels = c(1, 2, 3, 4))
proc_data$inmi_eco <- factor(proc_data$inmi_eco,
labels = c("Muy de acuerdo", "De acuerdo", "En desacuerdo", "Muy en desacuerdo"),
levels = c(1, 2, 3, 4))
graf_soc_diversa <- ggplot(proc_data, aes(x = soc_diversa)) +
geom_bar(fill = "pink") +
labs (title = "Percepción de la diversidad social")
graf_inmi_ideycul <- ggplot(proc_data, aes(x = inmi_ideycul)) +
geom_bar(fill = "pink") +
labs (title = "Interculturalidad")
graf_inmi_eco <- ggplot(proc_data, aes(x = inmi_eco)) +
geom_bar(fill = "pink") +
labs (title = "Impacto económico de los inmigrantes")
View(graf_soc_diversa)
View(graf_inmi_ideycul)
View(graf_inmi_eco)
ggsave(graf_inmi_eco, file="output/graf_inmi_eco.png")
ggsave(graf_inmi_ideycul, file="output/graf_inmi_ideycul.png")
proc_data$soc_diversa <- factor(proc_data$soc_diversa,
labels = c("Sociedad defiende costumbres", "Sociedad abierta a diversidad"),
levels = c(1, 2))
proc_data$inmi_ideycul <- factor(proc_data$inmi_ideycul,
labels = c("Muy de acuerdo", "De acuerdo", "En desacuerdo", "Muy en desacuerdo"),
levels = c(1, 2, 3, 4))
proc_data$inmi_eco <- factor(proc_data$inmi_eco,
labels = c("Muy de acuerdo", "De acuerdo", "En desacuerdo", "Muy en desacuerdo"),
levels = c(1, 2, 3, 4))
graf_soc_diversa <- ggplot(proc_data, aes(x = soc_diversa)) +
geom_bar(fill = "pink") +
labs (title = "Percepción de la diversidad social")
graf_inmi_llega <- ggplot(proc_data, aes(x = inmi_llega)) +
geom_bar(fill = "pink") +
labs (title = "Percepción de llegada de inmigrantes")
graf_inmi_ideycul <- ggplot(proc_data, aes(x = inmi_ideycul)) +
geom_bar(fill = "pink") +
labs (title = "Interculturalidad")
graf_inmi_crim <- ggplot(proc_data, aes(x = inmi_crim)) +
geom_bar(fill = "pink") +
labs (title = "Aumento inmigración-crimen")
graf_inmi_eco <- ggplot(proc_data, aes(x = inmi_eco)) +
geom_bar(fill = "pink") +
labs (title = "Impacto económico de los inmigrantes")
# Guardamos gráficos:
ggsave(graf_inmi_crim, file="output/graf_inmi_crim.png")
ggsave(graf_inmi_eco, file="output/graf_inmi_eco.png")
ggsave(graf_inmi_ideycul, file="output/graf_inmi_ideycul.png")
ggsave(graf_inmi_llega, file="output/graf_inmi_llega.png")
ggsave(graf_soc_diversa, file="output/graf_soc_diversa.png")
setwd("C:/Users/Javi/Desktop/Trabajo.3.Rstudio")
sjlabelled::get_label(proc_data)
proc_data$soc_diversa <- factor(proc_data$soc_diversa,
labels = c("Sociedad defiende costumbres", "Sociedad abierta a diversidad"),
levels = c(1, 2))
proc_data$inmi_ideycul <- factor(proc_data$inmi_ideycul,
labels = c("Muy de acuerdo", "De acuerdo", "En desacuerdo", "Muy en desacuerdo"),
levels = c(1, 2, 3, 4))
proc_data$inmi_eco <- factor(proc_data$inmi_eco,
labels = c("Muy de acuerdo", "De acuerdo", "En desacuerdo", "Muy en desacuerdo"),
levels = c(1, 2, 3, 4))
frq(proc_data$soc_diversa)
frq(proc_data$inmi_llega)
frq(proc_data$inmi_ideycul)
frq(proc_data$inmi_crim)
frq(proc_data$inmi_eco)
graf_soc_diversa <- ggplot(proc_data, aes(x = soc_diversa)) +
geom_bar(fill = "pink") +
labs (title = "Percepción de la diversidad social")
graf_inmi_llega <- ggplot(proc_data, aes(x = inmi_llega)) +
geom_bar(fill = "pink") +
labs (title = "Percepción de llegada de inmigrantes")
graf_inmi_ideycul <- ggplot(proc_data, aes(x = inmi_ideycul)) +
geom_bar(fill = "pink") +
labs (title = "Interculturalidad")
graf_inmi_crim <- ggplot(proc_data, aes(x = inmi_crim)) +
geom_bar(fill = "pink") +
labs (title = "Aumento inmigración-crimen")
graf_inmi_eco <- ggplot(proc_data, aes(x = inmi_eco)) +
geom_bar(fill = "pink") +
labs (title = "Impacto económico de los inmigrantes")
ggsave(graf_inmi_eco, file="output/graf_inmi_eco.png")
ggsave(graf_inmi_ideycul, file="output/graf_inmi_ideycul.png")
ggsave(graf_soc_diversa, file="output/graf_soc_diversa.png")
#Guardar base nueva
save(proc_data,file = "input/proc_data.RData")
#Comprobamos:
names(proc_data)
view_df(proc_data)
frq(proc_data$idenpa)
frq(proc_data$soc_diversa)
frq(proc_data$inmi_llega)
frq(proc_data$inmi_ideycul)
frq(proc_data$inmi_crim)
frq(proc_data$inmi_eco)
load("C:/Users/Javi/Desktop/Trabajo.3.Rstudio/input/Latinobarometro_2023_Esp_Rdata_v1_0r.RData")
load("C:/Users/Javi/Desktop/Trabajo.3.Rstudio/input/Latinobarometro_2023_Esp_Rdata_v1_0r.rdata")
load("C:/Users/Javi/Desktop/Trabajo.3.Rstudio/input/Latinobarometro_2023_Esp_Rdata_v1_0r.rdata.RData")
graf_esc <- ggplot(proc_data, aes(x = percepcion_impacto_integral_inmigrantes)) +
geom_histogram(binwidth = 0.6, colour = "black", fill = "yellow") +
theme_bw() +
xlab("Percepcion del impacto integral de inmigrantes") +
ylab("Frecuencia")
ggsave(graf_esc, file = "output/graf_esc.png")
